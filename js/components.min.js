var Time=React.createClass({displayName:"Time",render:function(){var e,t=moment(this.props.dateTime),a=t.format("YYYY-MM-DDTHH:mm:ssZ"),i=t.format("X")-moment().format("X"),s=t.format("YYYY-MM-DD")==moment().format("YYYY-MM-DD");return this.props.clever&&(console.log(i),e=s?t.format("h A"):t.calendar()),e||(e=t.format(this.props.format||"YYYY-MM-DD h a")),React.DOM.time({dateTime:a},e)}}),SignHeader=React.createClass({displayName:"SignHeader",loadBuildingDataFromServer:function(){$unibuddy.loadBuildingMeta(this.props.code,function(e){this.setState({buildingData:e})}.bind(this))},loadWeekDataFromServer:function(){$unibuddy.getWeek(function(e){this.setState({weekData:e})}.bind(this))},getInitialState:function(){return{buildingData:{code:"",name:""},weekData:{semester:"",week:""}}},componentWillMount:function(){this.loadBuildingDataFromServer(),this.loadWeekDataFromServer()},render:function(){return React.DOM.div({className:"signHeader"},React.DOM.img({className:"logo",src:"images/flinders-logo.png"}),React.DOM.h1(null,"Welcome to ",this.state.buildingData.name),React.DOM.span({className:"week"},this.state.weekData.week," (",this.state.weekData.semester,")"))}}),BuildingBookings=React.createClass({displayName:"BuildingBookings",loadDataFromServer:function(){$unibuddy.loadRooms(this.props.code,function(e){this.setState({data:e})}.bind(this))},getInitialState:function(){return{data:[]}},componentWillMount:function(){this.loadDataFromServer(),this.props.polling&&setInterval(loadDataFromServer,this.props.polling)},render:function(){var e=React.addons.classSet,t=this.state.data.map(function(t){var a=e({room:!0,empty:t.is_empty});return React.DOM.tr({className:a},React.DOM.td(null,t.code," ",t.name),React.DOM.td(null,RoomBooking({booking:t.current_booking})),React.DOM.td(null,RoomBooking({booking:t.next_booking})))}),a=ReactBootstrap.Table;return React.DOM.div(null,React.DOM.h2(null,this.props.code," Room Bookings"),a({condensed:!0,className:"bookings"},React.DOM.thead(null,React.DOM.tr(null,React.DOM.th({className:"roomLabel"},"Room"),React.DOM.th({className:"booking current"},"Currently"),React.DOM.th({className:"booking next"},"Next"))),React.DOM.tbody(null,t)))}}),RoomBooking=React.createClass({displayName:"RoomBooking",render:function(){var e=this.props.booking;if(!e)return React.DOM.span({className:"booking empty"},"Free");var t=moment(e.starts_at).format("X")-moment().format("X");return t>86400?React.DOM.span({className:"booking empty"},"Free"):React.DOM.span({className:"booking"},e.booked_for," ",React.DOM.small(null,e.description)," ",Time({clever:!0,dateTime:e.starts_at}))}}),BuildingSlideshow=React.createClass({displayName:"BuildingSlideshow",getInitialState:function(){return{slide:void 0,slideNumber:-1}},componentWillMount:function(){var e=function(){try{this.state.slideNumber++,this.state.slide=this.props.slides[this.state.slideNumber%this.props.slides.length],this.forceUpdate()}catch(t){console.error(t)}setTimeout(e,this.state.slide.duration)};(e=e.bind(this))()},render:function(){var e=this.state.slide;return React.DOM.div({className:"buildingSlideshow"},TimedProgressBar({duration:e.duration}),SignHeader({code:this.props.code}),e.content)}}),NewsArticle=React.createClass({displayName:"NewsArticle",render:function(){var e=this.props.article;return React.DOM.article({className:"news"},React.DOM.img({className:"articleImage",src:e.image}),React.DOM.h3(null,e.title),React.DOM.p(null,e.plaintext))}}),NewsFeed=React.createClass({displayName:"NewsFeed",loadDataFromServer:function(){$unibuddy.getNews(function(e){return this.setState({data:e})}.bind(this))},getInitialState:function(){return{data:[]}},componentWillMount:function(){this.loadDataFromServer(),this.props.polling&&setInterval(this.loadDataFromServer,this.props.polling)},render:function(){var e=this.state.data.slice(0,2).map(function(e){return NewsArticle({article:e})});return React.DOM.div({className:"newsFeed"},React.DOM.h2(null,"News"),e)}}),TimedProgressBar=React.createClass({displayName:"TimedProgressBar",getInitialState:function(){return{going:!1}},componentWillMount:function(){this.componentWillReceiveProps()},componentWillReceiveProps:function(){this.state.going=!1,setTimeout(function(){this.forceUpdate()}.bind(this),10)},render:function(){var e=(ReactBootstrap.ProgressBar,React.DOM.div({className:"progress slideIndicator"},React.DOM.div({className:"progress-bar",style:{width:this.state.going?"100%":"0%",transition:"width "+(this.state.going?this.props.duration:0)+"ms linear"}})));return this.state.going=!0,e}});